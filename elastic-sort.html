<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="./elasticjs.html">
<!--
An element that creates an ejs.Sort() object to pass onto elastic-client-search
based on user input.

Example:

    <elastic-sort input-string="Sort('_score').order('desc')"></elastic-sort>

@element elastic-sort
@demo demo/index.html
-->

<script>
  Polymer({

    is: 'elastic-sort',

    properties: {

      /**
       * String in correct format to create ejs.Sort() object with. If string is 
       * invalid, lastError will be updated.
       */
      inputString: {
        type: String,
        notify: true,
        observer: 'createEjsSort'
      },
      /**
       * ejs.Sort() object to propagate
       */
      sort: {
        type: Object,
        value: function() {
          return {};
        },
        readOnly: true,
        notify: true
      },
      /**
       * If error occurs in creation of ejs.Sort() object, it will be stored here.
       * Otherwise will be left empty. 
       */
      lastError: {
        type: Object,
        value: function() {
          return {};
        },
        readOnly: true,
        notify: true
      }

    },
    createEjsSort: function() {
      /* jshint -W061 */
      if(this.inputString && this.inputString.length > 0) {
          try {
            this._setSort(eval('ejs.' + this.inputString));
          } catch(err) {
            // capture error in lastError property
            this._setLastError(err);
          }
        }
    }

  });

</script>

<link rel="import" href="../polymer/polymer.html">
<script src="../elastic.js/dist/elastic.js"></script>

<!--
A Polymer element that creates an ejs.Sort() object based on user input.

### Example
```html
<elastic-sort input-string="Sort('_score').order('desc')"></elastic-sort>
```

@demo demo/index.html
-->

<script>
  Polymer({
    is: 'elastic-sort',

    properties: {
      /**
       * (Required)
       *
       * String in correct format to create ejs.Sort() object with. If string is invalid, lastError will be updated.
       *
       * @type {String}
       */
      inputString: {
        type: String,
        notify: true,
        observer: '_buildSort'
      },

      /**
       * (Output)
       *
       * The ejs.Sort() object.
       *
       * @type {Object}
       * @defualt {}
       */
      sort: {
        type: Object,
        value: function() {
          return {};
        },
        readOnly: true,
        notify: true
      },

      /**
       * (Output)
       *
       * If error occurs in creation of ejs.Sort() object, it will be stored here.
       * Otherwise will be left empty. 
       *
       * @type {Object}
       * @default {}
       */
      lastError: {
        type: Object,
        value: function() {
          return {};
        },
        readOnly: true,
        notify: true
      }
    },

    /**
     * Builds the elasticjs sort object.
     *
     * @private
     */
    _buildSort: function() {
      /* jshint -W061 */
      if(this.inputString && this.inputString.length > 0) {
          try {
            this._setSort(eval('ejs.' + this.inputString));
          } catch(err) {
            this._setLastError(err);
          }
        }
    }
  });
</script>
